<!DOCTYPE html>
<!-- password-protected.html -->
<script>
  const PASSWORD_HASH = "5e0c1a07153d9de847442685ecd62a499ad2c2ab8ad1368c520226fe507bf124"; 

  async function checkPassword() {
    const input = document.getElementById("passwordInput").value;
    const msg = document.getElementById("message");
    const enc = new TextEncoder();
    const buf = await crypto.subtle.digest("SHA-256", enc.encode(input));
    const hash = Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, "0")).join("");

    if (hash === PASSWORD_HASH) {
      document.getElementById("login").style.display = "none";
      document.getElementById("main").style.display = "block";
    } else {
      msg.textContent = "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™";
    }
  }
</script>

<div id="login" style="padding:20px">
  <h2>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h2>
  <input type="password" id="passwordInput">
  <button onclick="checkPassword()">ãƒ­ã‚°ã‚¤ãƒ³</button>
  <div id="message" style="color:red; margin-top:10px;"></div>

</div>

<div id="main" style="display:none">
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ£šå‰²AIãƒãƒ‡ã‚£ãƒ¢ãƒƒã‚¯</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --suntory-blue: #0078BD;
      --suntory-gold: #C8A951;
      --light-bg: #f4fafd;
      --text-dark: #1e1e1e;
    }

    body {
      font-family:  'Segoe UI', 'Helvetica Neue', sans-serif;
      margin: 0;
      padding: 0;
      background: #eafaff;
      color:#222;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      background: white;
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.06);
      margin-top: 50px;
    }

    h1 {
      text-align: center;
      color: var(--suntory-blue);
      font-weight: 700;
      margin-bottom: 30px;
    }

    h2 {
      color: var(--suntory-blue);
      border-left: 6px solid #83d3e2;
      padding-left: 10px;
      margin-top: 40px;
    }

    img {
      width: 100%;
      border-radius: 10px;
      margin-top: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .input-area {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 16px;
      justify-content: flex-start;
    }

    .input-box {
      background: #f7f9fb;
      text-align: center;
      border: 2px solid #d0e6f5;
      padding: 10px;
      border-radius: 6px;
      width: 150px;
      font-size: 13px;
    }

    .input-box label {
      margin: 0;
      font-size: 13px;
      font-weight: normal;
      margin-bottom: 4px;
      display: block;

    }

    .input-box .percent {
      font-size: 14px;
      font-weight: normal;
      display: inline;
    }

    .input-box .diff {
      font-size: 12px;
      font-weight: bold;
      display: inline;
      margin-left: 5px;
    }

    .diff.plus {
      color: #2ecc71;
    }

    .diff.minus {
      color: #e74c3c;
    }

    .share-box {
      margin-top: 20px;
      background: #eaf5ff;
      border-left: 6px solid #0078BD;
      border-radius: 10px;
      padding: 15px;
      max-width: 300px;
    }

    .share-label {
      font-size: 14px;
      font-weight: bold;
      color: #0078BD;
    }

    .share-value {
      font-size: 24px;
      font-weight: bold;
      margin-top: 8px;
      color: #2c3e50;
    }

    .highlight {
      font-size: 20px;
      font-weight: bold;
      color: #d35400;
      margin-top: 5px;
      text-align: left;
    }

    button {
      display: block;
      margin: 20px auto 10px auto;
      padding: 12px 24px;
      background-color: var(--suntory-blue);
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #005f97;
    }

.button-large {
  background-color: #0078BD;              
  color: #ffffff;                         
  border: 2px solid #0078BD;              /* å®Ÿç·šã«å¤‰æ›´ã€ã‚«ãƒ©ãƒ¼ã¯ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ */
  font-weight: bold;
  font-size: 16px;
  padding: 14px 24px;
  border-radius: 10px;
  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  transition: background 0.3s;
  display: inline-block;
}

.upload-style {
  background-color: #f9f2e7;
  color: #333;
  border: 2px dashed #c3975b;
  font-weight: bold;
  font-size: 16px;
  padding: 14px 24px;
  border-radius: 10px;
  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  transition: background 0.3s;
  display: inline-block;
  margin: 0;
}

.upload-style:hover {
  background-color: #f2e1c9;
  cursor: pointer;
}

    .footer {
      text-align: center;
      font-size: 12px;
      color: #888;
      margin-top: 60px;
      display: block;
    }

    .share-box.left-align {
      margin-left: 0;
    }

    /* ã‚¹ãƒ”ãƒŠãƒ¼ç”¨ */
    .spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid #ccc;
      border-top: 3px solid #0078BD;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      vertical-align: middle;
      margin-right: 10px;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

.typing {
  display: inline-block;
  position: relative;
  width: 40px;
  height: 14px;
}

.typing span {
  display: inline-block;
  position: absolute;
  width: 8px;
  height: 8px;
  background: #999;
  border-radius: 50%;
  animation: typing 1.4s infinite ease-in-out both;
}

.typing span:nth-child(1) { left: 0px; animation-delay: -0.32s; }
.typing span:nth-child(2) { left: 12px; animation-delay: -0.16s; }
.typing span:nth-child(3) { left: 24px; }

@keyframes typing {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1.0); }
}

    /* âœ… ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®è‰²åˆ†ã‘ */
    .beer-card   { background: #ffffff; border: 2px solid #f5d76e;} /* ãƒ“ãƒ¼ãƒ«ï¼šæ·¡ã„é»„è‰² */
    .rtd-card    { background: #ffffff; border: 2px solid #f5a9b8;} /* RTDï¼šæ·¡ã„æ°´è‰² */
    .nonal-card  { background: #ffffff; border: 2px solid #84e0b4;} /* ãƒãƒ³ã‚¢ãƒ«ï¼šæ·¡ã„ç·‘ */

    /* 2-1 æ•°å­—å¼·èª¿ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆç¾åœ¨ãƒ»æ”¹å–„æ¡ˆã§å…±é€šï¼‰ */
    .ratio-wrap { display: flex; gap: 20px; margin-top: 10px; }
    .ratio-item { flex: 1; text-align: center; }
    .ratio-num  { font-size: 28px; font-weight: bold; }
.ratio-chip {
  display: block;           /* inline-block â†’ block ã«ã™ã‚‹ */
  width: 100%;               /* è¦ªè¦ç´ ã®å¹…ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
  padding: 4px 0;            /* ä¸Šä¸‹ã ã‘ä½™ç™½ã‚’ã¨ã‚‹ */
  font-size: 14px;
  border-radius: 4px;
  box-sizing: border-box;    /* paddingå«ã‚ã¦å¹…è¨ˆç®— */
}
    .ratio-delta { font-size: 12px; font-weight: bold; margin-top: 4px; display: block; }
    .ratio-delta.plus { color: green; }
    .ratio-delta.minus { color: red; }

    .ratio-num.beer   { color: #b37400; }  .ratio-chip.beer   { background: #fff7e6; }
    .ratio-num.rtd    { color: #8C0000; }  .ratio-chip.rtd    { background: #FFE6F9; }
    .ratio-num.nonal  { color: #00783B; }  .ratio-chip.nonal  { background: #e6fff0; }
  
/* å¹ãå‡ºã—ãƒ–ãƒ­ãƒƒã‚¯ */
.ai-reason {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-top: 16px;
}

/* ãƒ­ãƒœãƒƒãƒˆç”»åƒï¼ˆãªã‘ã‚Œã°ä¸€æ—¦ emoji ğŸ¤– ã§ã‚‚OKï¼‰ */
.ai-icon {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  object-fit: cover; /* ç”»åƒãŒå°ã•ãã¦ã‚‚å´©ã‚Œã«ãã„ */
}

/* å¹ãå‡ºã—æœ¬ä½“ */
.ai-bubble {
  position: relative;
  background: #ffffff;                 /* èƒŒæ™¯ã¯ç™½ã« */
  border: 1px solid #e5e7eb;           /* è–„ã„æ ç·šã§å¹ãå‡ºã—æ„ŸUP */
  border-radius: 12px;
  padding: 12px 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.06);
  font-size: 14px;
  line-height: 1.6;
  max-width: 680px;
}

/* ã—ã£ã½ï¼ˆå¤–å´ï¼šæ ç·šç”¨ï¼‰ */
.ai-bubble::before {
  content: "";
  position: absolute;
  top: 22px;             /* ç¸¦ä½ç½®ã¯å¥½ã¿ã§å¾®èª¿æ•´ */
  left: -14px;           /* å¹ãå‡ºã—ã®å¤–ã«å‡ºã™ */
  border-width: 8px;
  border-style: solid;
  border-color: transparent #e5e7eb transparent transparent;
}

/* ã—ã£ã½ï¼ˆå†…å´ï¼šèƒŒæ™¯è‰²ç”¨ï¼‰ */
.ai-bubble::after {
  content: "";
  position: absolute;
  top: 22px;
  left: -12px;           /* å¤–å´ã‚ˆã‚Šå°‘ã—å†…å´ã« */
  border-width: 8px;
  border-style: solid;
  border-color: transparent #ffffff transparent transparent;
}

.ai-bubble p {
  margin: 0 0 6px;
}
.ai-bubble p:last-child {
  margin-bottom: 0;
}

/* ãƒ¢ãƒã‚¤ãƒ«ã§å¹…ãŒç‹­ã„ã¨ãã¯ç¸¦ç©ã¿ã«ã™ã‚‹ï¼ˆä»»æ„ï¼‰ */
@media (max-width: 560px) {
  .ai-reason { align-items: center; }
  .ai-bubble { max-width: 100%; }
}
.hidden {
  display: none;
}

.typing {
  display: inline-block;
  width: 4px;
  height: 4px;
  margin: 0 2px;
  background: #004d61;
  border-radius: 50%;
  animation: typing 1s infinite;
}
.typing:nth-child(2) { animation-delay: 0.2s; }
.typing:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing {
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.5); opacity: 0.5; }
  100% { transform: scale(1); opacity: 1; }
}
    #chatLog {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 20px;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      min-height: 100px;
    }
    .chat-message {
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }
    .chat-user {
      justify-content: flex-end;
    }
    .chat-user .chat-bubble {
      background: #e0f0ff;
      color: #003366;
      align-self: flex-end;
    }
    .chat-ai {
      justify-content: flex-start;
    }
    .chat-bubble {
      max-width: 70%;
      padding: 10px 15px;
      border-radius: 12px;
      background: #f0f0f0;
      line-height: 1.5;
      box-shadow: 1px 1px 5px rgba(0,0,0,0.05);
    }
.chat-input-area {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  gap: 8px;
  margin-top: 10px;
}

.chat-input-area input[type="text"] {
  flex: 1;
  padding: 8px;
  font-size: 14px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

.chat-input-area button {
  padding: 8px 16px;
  font-size: 14px;
  background-color: #0078BD;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

</style>
</head>
<body>
  <div class="container">
    <h1>æ£šå‰²AIãƒãƒ‡ã‚£ãƒ¢ãƒƒã‚¯ Ver2.0</h1>

    <h2>â‘  ç¾çŠ¶æ£šå‰²ã‚Šè¡¨ç¤º</h2>
    <img src="ä»Šã®ãƒ“ãƒ¼ãƒ«æ£šå‰²ã‚Š_å…¨ã‚«ãƒ†ï¼ˆå‰ï¼‰.png" alt="æ£šå‰²ã‚Šç”»åƒ" style="width: 950px; height: auto;">

    <h2>â‘¡ ç¾åœ¨ã®æ§‹æˆæ¯”</h2>
  <!-- 2-1.ã‚«ãƒ†ã‚´ãƒªæ§‹æˆæ¯”ï¼ˆã‚«ãƒ¼ãƒ‰è¡¨ç¤ºï¼‰ -->
<h3 style="color:#0078BD; margin-top: 30px;">2-1.ã‚«ãƒ†ã‚´ãƒªæ§‹æˆæ¯”</h3>
  <div class="ratio-wrap" id="currentCategoryRatio">
    <div class="ratio-item">
      <div class="ratio-num beer" id="ratio-beer">6</div>
      <span class="ratio-chip beer">ãƒ“ãƒ¼ãƒ«</span>
    </div>
    <div class="ratio-item">
      <div class="ratio-num rtd" id="ratio-rtd">3.5</div>
      <span class="ratio-chip rtd">RTD</span>
    </div>
    <div class="ratio-item">
      <div class="ratio-num nonal" id="ratio-nonal">0.5</div>
      <span class="ratio-chip nonal">ãƒãƒ³ã‚¢ãƒ«</span>
    </div>
  </div>
  <div class="section-caption">â€» æ•°å­—ã¯ã‚«ãƒ†ã‚´ãƒªæ¯”ç‡ï¼ˆä¾‹ï¼šãƒ“ãƒ¼ãƒ«ï¼šRTDï¼šãƒãƒ³ã‚¢ãƒ« ï¼ 6ï¼š3.5ï¼š0.5ï¼‰</div>

  <!-- 2-2.ã‚µãƒ–ã‚«ãƒ†æ§‹æˆæ¯”ï¼ˆã‚«ãƒ¼ãƒ‰è¡¨ç¤ºï¼‰ -->
  <h3 style="color:#0078BD; margin-top: 30px;">2-2.ã‚µãƒ–ã‚«ãƒ†æ§‹æˆæ¯”</h3>

  <!-- ãƒ“ãƒ¼ãƒ« -->
  <p><strong>ãƒ“ãƒ¼ãƒ«</strong></p>
  <div class="input-area" id="currentBeer">
    <div class="input-box beer-card"><label>ã‚¯ãƒ©ãƒ•ãƒˆ</label><div class="percent">15%</div></div>
    <div class="input-box beer-card"><label>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ“ãƒ¼ãƒ«</label><div class="percent">13%</div></div>
    <div class="input-box beer-card"><label>ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰</label><div class="percent">25%</div></div>
    <div class="input-box beer-card"><label>æ©Ÿèƒ½æ€§</label><div class="percent">7%</div></div>
    <div class="input-box beer-card"><label>ã‚¨ã‚³ãƒãƒŸãƒ¼</label><div class="percent">40%</div></div>
  </div>
  <!-- RTD -->
  <p><strong>RTD</strong></p>
  <div class="input-area" id="currentRTD">
    <div class="input-box rtd-card"><label>ä½ã‚¢ãƒ«</label><div class="percent">8%</div></div>
    <div class="input-box rtd-card"><label>é«˜ã‚¢ãƒ«</label><div class="percent">13%</div></div>
    <div class="input-box rtd-card"><label>ç„¡ç³–</label><div class="percent">25%</div></div>
    <div class="input-box rtd-card"><label>ä¸­ã‚¢ãƒ«</label><div class="percent">11%</div></div>
    <div class="input-box rtd-card"><label>ãƒ¬ãƒ¢ãƒ³ã‚µãƒ¯ãƒ¼</label><div class="percent">13%</div></div>
    <div class="input-box rtd-card"><label>ç„¼é…ç³»</label><div class="percent">10%</div></div>
    <div class="input-box rtd-card"><label>ãƒãƒ©ã‚¨ãƒ†ã‚£ã‚µãƒ¯ãƒ¼</label><div class="percent">3%</div></div>
    <div class="input-box rtd-card"><label>ãƒã‚¤ãƒœãƒ¼ãƒ«ãƒ»ã‚¸ãƒ³ã‚½ãƒ¼ãƒ€</label><div class="percent">17%</div></div>
  </div>

  <!-- ãƒãƒ³ã‚¢ãƒ« -->
  <p><strong>ãƒãƒ³ã‚¢ãƒ«</strong></p>
  <div class="input-area" id="currentNonal">
    <div class="input-box nonal-card"><label>RTDãƒ†ã‚¤ã‚¹ãƒˆ</label><div class="percent">30%</div></div>
    <div class="input-box nonal-card"><label>ãƒ“ãƒ¼ãƒ«ãƒ†ã‚¤ã‚¹ãƒˆ</label><div class="percent">70%</div></div>
  </div>

    <h2>â‘¢ SKUã‚·ã‚§ã‚¢</h2>
    <div class="share-box left-align">
      <div class="share-label">SKUã‚·ã‚§ã‚¢</div>
      <div class="share-value"><span id="currentShare">21.8</span>%</div>
    </div>


 <!-- æ”¹å–„æ¡ˆãƒ–ãƒ­ãƒƒã‚¯ -->
  <div class="section">
<h2>â‘£ æ£šå‰²æ”¹å–„æ¡ˆ</h2>

<!-- ç–‘ä¼¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ -->
<div class="upload-button-wrapper">
  <input type="file" id="uploadInput" accept="image/*" style="display:none" onchange="simulateUpload()">
  <button class="custom-upload-btn upload-style" onclick="document.getElementById('uploadInput').click()">
    ğŸ“¤ æ”¹å–„æ¡ˆã®æ£šå‰²ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  </button>
</div>

    <div id="uploadSpinner" class="hidden">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</div>
    <div id="uploadedImprovementArea" class="hidden">
      <img src="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨ç”»åƒ.png" alt="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸæ”¹å–„æ¡ˆ" style="width: 950px; height: auto; margin-top: 10px;">

<button class="button-large" onclick="showImprovement()">ğŸ“Š æ§‹æˆæ¯”ã¨SKUã‚·ã‚§ã‚¢ã‚’ç®—å‡ºã™ã‚‹</button>
    </div>
  </div>
  <!-- ã‚¯ãƒ«ã‚¯ãƒ«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
  <div id="loadingSpinner01" style="display:none; margin: 20px;">
    <span class="spinner"></span> è¨ˆç®—ä¸­...
  </div>

  <!-- 4-1, 4-2, SKUã‚·ã‚§ã‚¢è¦‹è¾¼ã¿ -->
  <div class="section hidden" id="analysisSection">
    <h3 style="color:#0078BD; margin-top: 24px;">4-1.ã‚«ãƒ†ã‚´ãƒªæ§‹æˆæ¯”ï¼ˆæ”¹å–„æ¡ˆï¼‰</h3>
    <div class="ratio-wrap" id="improvedCategoryRatio">
      <div class="ratio-item">
        <div class="ratio-num beer" id="improved-beer"></div>
        <span class="ratio-chip beer">ãƒ“ãƒ¼ãƒ«</span>
        <span class="ratio-delta" id="delta-beer"></span>
      </div>
      <div class="ratio-item">
        <div class="ratio-num rtd" id="improved-rtd"></div>
        <span class="ratio-chip rtd">RTD</span>
        <span class="ratio-delta" id="delta-rtd"></span>
      </div>
      <div class="ratio-item">
        <div class="ratio-num nonal" id="improved-nonal"></div>
        <span class="ratio-chip nonal">ãƒãƒ³ã‚¢ãƒ«</span>
        <span class="ratio-delta" id="delta-nonal"></span>
      </div>
    </div>
    <div class="section-caption">â€» å·®åˆ†ã¯ç¾åœ¨ï¼ˆ2-1ï¼‰ã®æ¯”ç‡ã¨ã®å·®ã§ã™ï¼ˆå˜ä½ã¯æ¯”ç‡ã®ã¾ã¾ï¼‰ã€‚</div>

    <!-- â‘£-2 ã‚µãƒ–ã‚«ãƒ†æ§‹æˆæ¯”ï¼ˆæ”¹å–„æ¡ˆï¼šãƒ“ãƒ¼ãƒ«ï¼RTDï¼ãƒãƒ³ã‚¢ãƒ«ï¼‰ -->
    <h3 style="color:#0078BD; margin-top: 24px;">4-2.ã‚µãƒ–ã‚«ãƒ†æ§‹æˆæ¯”ï¼ˆæ”¹å–„æ¡ˆï¼‰</h3>

    <!-- ãƒ“ãƒ¼ãƒ«ï¼ˆæ”¹å–„æ¡ˆï¼‰ -->
    <p><strong>ãƒ“ãƒ¼ãƒ«</strong></p>
    <div class="input-area" id="improvedBeer">
      <div class="input-box beer-card"><label>ã‚¯ãƒ©ãƒ•ãƒˆ</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box beer-card"><label>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ“ãƒ¼ãƒ«</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box beer-card"><label>ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box beer-card"><label>æ©Ÿèƒ½æ€§</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box beer-card"><label>ã‚¨ã‚³ãƒãƒŸãƒ¼</label><div class="percent"></div><div class="diff"></div></div>
    </div>

    <!-- RTDï¼ˆæ”¹å–„æ¡ˆï¼‰ -->
    <p><strong>RTD</strong></p>
    <div class="input-area" id="improvedRTD">
      <div class="input-box rtd-card"><label>ä½ã‚¢ãƒ«</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>é«˜ã‚¢ãƒ«</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ç„¡ç³–</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ä¸­ã‚¢ãƒ«</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ãƒ¬ãƒ¢ãƒ³ã‚µãƒ¯ãƒ¼</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ç„¼é…ç³»</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ãƒãƒ©ã‚¨ãƒ†ã‚£ã‚µãƒ¯ãƒ¼</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box rtd-card"><label>ãƒã‚¤ãƒœãƒ¼ãƒ«ãƒ»ã‚¸ãƒ³ã‚½ãƒ¼ãƒ€</label><div class="percent"></div><div class="diff"></div></div>
    </div>

    <!-- ãƒãƒ³ã‚¢ãƒ«ï¼ˆæ”¹å–„æ¡ˆï¼‰ -->
    <p><strong>ãƒãƒ³ã‚¢ãƒ«</strong></p>
    <div class="input-area" id="improvedNonal">
      <div class="input-box nonal-card"><label>RTDãƒ†ã‚¤ã‚¹ãƒˆ</label><div class="percent"></div><div class="diff"></div></div>
      <div class="input-box nonal-card"><label>ãƒ“ãƒ¼ãƒ«ãƒ†ã‚¤ã‚¹ãƒˆ</label><div class="percent"></div><div class="diff"></div></div>
    </div>

      <div class="share-box">
        <div class="share-label">SKUã‚·ã‚§ã‚¢è¦‹è¾¼ã¿ï¼ˆæ”¹å–„æ¡ˆï¼‰</div>
        <div class="share-value" id="improvedShareDisplay">25.1%</div>
      </div>

      <div class="highlight" id="improvementText"></div>

    <button class="button-large" onclick="showAiComment()">ğŸ¤–AIãƒãƒ‡ã‚£ã«ç›¸è«‡ã™ã‚‹</button>
  </div>

<!-- ã‚¯ãƒ«ã‚¯ãƒ«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
<div id="loadingSpinner" class="hidden" style="margin: 20px; font-size: 14px;">
  <span class="spinner"></span> AIãŒæ”¹å–„æ¡ˆã‚’åˆ†æä¸­ã§ã™...
</div>


<!-- æ”¹å–„ç†ç”±ï¼ˆAIãƒ­ãƒœãƒƒãƒˆèª¬æ˜ï¼‰ -->
  <div id="aiReasoning" class="hidden section">
    <div class="ai-reason">
  <img src="AIã‚¤ãƒ©ã‚¹ãƒˆ.png" alt="AIãƒ­ãƒœãƒƒãƒˆ" class="ai-icon">
  <div class="ai-bubble">
      <p>ç´ æ™´ã‚‰ã—ã„æ”¹å–„æ¡ˆã§ã™ã­ï¼SKUã‚·ã‚§ã‚¢ãŒæ”¹å–„ã•ã‚Œã€ã¨ã¦ã‚‚é­…åŠ›çš„ãªæ£šå‰²ã‚Šã«ä»•ä¸ŠãŒã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>
      <p>ã“ã®ã‚¾ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ˆã£ã¦ã€ãƒã‚§ãƒ¼ãƒ³æ§˜ã«ã¨ã£ã¦ã©ã‚“ãªãƒ¡ãƒªãƒƒãƒˆãŒæœŸå¾…ã§ãã‚‹ã®ã‹ã€ç§ã‹ã‚‰ç°¡å˜ã«ã”æ¡ˆå†…ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
      <br>
      <p>ã¾ãšã€RTDã¨ãƒãƒ³ã‚¢ãƒ«ã¯å¸‚å ´å…¨ä½“ã§ã‚‚ã€â—‹â—‹ãƒã‚§ãƒ¼ãƒ³ã§ã‚‚å¼•ãç¶šãä¼¸é•·ã—ã¦ãŠã‚Šã€<strong>å®¢æ•°ã‚¢ãƒƒãƒ—ã®ã‚«ã‚®</strong>ã¨ãªã‚‹é‡è¦ãªã‚«ãƒ†ã‚´ãƒªã§ã™ã€‚</p>
<p>ãã®æ¯”ç‡ãŒå¼·åŒ–ã•ã‚Œã¦ã„ã‚‹ç‚¹ã¯ã€ã¨ã¦ã‚‚è‰¯ã„åˆ¤æ–­ã ã¨æ€ã„ã¾ã™ï¼</p>
      <p>ç‰¹ã«RTDã§ã¯ã€<strong>ãƒã‚¤ãƒœãƒ¼ãƒ«ãƒ»ã‚¸ãƒ³ã‚½ãƒ¼ãƒ€ã€ç„¡ç³–ã€ä½ã‚¢ãƒ«</strong>ã®3ã‚«ãƒ†ã‚´ãƒªãŒé¡•è‘—ã«æˆé•·ä¸­ã§ã™ã€‚</p>
<p>ã“ã‚Œã‚‰ã‚’ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªã§ã—ã£ã‹ã‚Šå¼·åŒ–ã™ã‚‹ã“ã¨ã§ã€**å£²å ´ã®ã€Œä»Šæ„Ÿã€**ãŒä¸€å±¤ä¼ã‚ã‚Šã‚„ã™ããªã‚Šã¾ã™ï¼</p>
      <p>ã“ã®ä¸­ã§ã‚‚ã€Œãƒã‚¤ãƒœãƒ¼ãƒ«ãƒ»ã‚¸ãƒ³ã‚½ãƒ¼ãƒ€ã€ã¯ã€å½“ç¤¾ã®<strong>å£²ä¸Šæ‹¡å¤§åŠ¹æœãŒé«˜ãã€æ­»å®ˆã—ãŸã„ãƒã‚¸ã‚·ãƒ§ãƒ³</strong>ã§ã™ï¼</p>
      <br>
      <p>ãƒãƒ³ã‚¢ãƒ«ã¯ã€Œãƒ“ãƒ¼ãƒ«ç³»ã€ã¨ã€ŒRTDãƒ†ã‚¤ã‚¹ãƒˆç³»ã€ã®ä¸¡æ–¹ã§å®¢æ•°ãŒä¼¸ã³ã¦ãŠã‚Šã€</p>
      <p>1:1ã®æ¯”ç‡ã§æ£šã‚’æ§‹æˆã™ã‚‹ã“ã¨ã§ã€<strong>å®¢å˜ä¾¡ãƒ»å®¢æ•°ãƒ»ä½µé£²ç‡</strong>ã®æœ€å¤§åŒ–ãŒæœŸå¾…ã§ãã¾ã™ã€‚</p>
      <br>
      <p>ãƒ“ãƒ¼ãƒ«ã‚«ãƒ†ã‚´ãƒªã«ã¤ã„ã¦ã¯ã€é…’ç¨æ”¹æ­£ã®å½±éŸ¿ã§ã€Œã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãƒ“ãƒ¼ãƒ«é›¢ã‚Œã€ãŒè¦‹è¾¼ã¾ã‚Œã¾ã™ãŒã€</p>
      <p>ãã®åˆ†ã€<strong>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚„æ©Ÿèƒ½æ€§ãƒ“ãƒ¼ãƒ«</strong>ã‚’ã—ã£ã‹ã‚Šã¨æ£šã«é…ç½®ã™ã‚‹ã“ã¨ã§ã€â—‹â—‹ãƒã‚§ãƒ¼ãƒ³æ§˜ã®æˆ¦ç•¥ã¨ã‚‚ãƒãƒƒãƒã™ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚</p>
      <br>
      <p>ã”ä¸æ˜ç‚¹ã‚„ã‚‚ã£ã¨æ·±æ˜ã‚Šã—ãŸã„å†…å®¹ãŒã‚ã‚Œã°ã€ãœã²ä¸‹ã®ãƒãƒ£ãƒƒãƒˆæ¬„ã§ã”ç›¸è«‡ãã ã•ã„ã­ã€‚</p>
      <p><strong>ä¸€ç·’ã«ã€æœ€é©ãªææ¡ˆã‚’ä½œã£ã¦ã„ãã¾ã—ã‚‡ã†ï¼</strong>ğŸ’ª</p>
  </div>
</div>

      <!-- ãƒãƒ£ãƒƒãƒˆ -->
      <div id="chatBox" style="margin-top: 40px;">
        <h3 style="color:#0078BD;">AIãƒãƒ‡ã‚£ã¸ã®è³ªå•ãƒ»è¦æœ›</h3>

<div id="chatLog" class="chat-container"></div>

<div class="chat-input-area">
  <input id="chatInput" type="text" placeholder="è³ªå•ã‚„è¦æœ›ã‚’å…¥åŠ›" style="width: 70%; padding: 6px;" />
  <button onclick="submitChat()">é€ä¿¡</button>
</div>

      </div>
    </div>
  </div>
  </div>
  <div class="footer">Â© ãŸãªã¹ ãƒ¢ãƒƒã‚¯ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆè©¦ä½œï¼‰</div>

  <script>
function simulateUpload() {
  const spinner = document.getElementById("uploadSpinner");
  const area = document.getElementById("uploadedImprovementArea");
  spinner.style.display = "block";
  area.style.display = "none";

  setTimeout(() => {
    spinner.style.display = "none";
    area.style.display = "block";
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  }, 2000); // ç–‘ä¼¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼š2ç§’å¾Œã«ç”»åƒè¡¨ç¤º
}


    function safeParsePercent(text) {
      const n = parseInt(String(text).replace('%','').replace('ã€‡','').trim());
      return isNaN(n) ? 0 : n;
    }

function showImprovement() {
  document.getElementById("loadingSpinner01").style.display = "block";
  document.getElementById("analysisSection").style.display = "none";

    const section = document.getElementById("analysisSection");
    if (section) {
      section.classList.remove("hidden"); // ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆ
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    } else {
      console.warn("analysisSection ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
    }


  setTimeout(() => {
    document.getElementById("loadingSpinner01").style.display = "none";
    document.getElementById("analysisSection").style.display = "block";

    /* SKUã‚·ã‚§ã‚¢è¦‹è¾¼ã¿ */
    const improvedShare = 25.1;
    const currentShare = parseFloat(document.getElementById("currentShare").textContent);
    const shareDiff = (improvedShare - currentShare).toFixed(1);
    const shareSign = shareDiff >= 0 ? "+" : "";
    document.getElementById("improvedShareDisplay").innerHTML = 
      `${improvedShare}% <small>ï¼ˆ${shareSign}${shareDiff}ptï¼‰</small>`;
    document.getElementById("improvementText").textContent = 
      `SKUã‚·ã‚§ã‚¢ ${shareSign}${shareDiff}pt æ”¹å–„ï¼`;

    /* 4-1 ã‚«ãƒ†ã‚´ãƒªæ§‹æˆæ¯” */
    const currentCategory = {
      beer: parseFloat(document.getElementById('ratio-beer').textContent),
      rtd: parseFloat(document.getElementById('ratio-rtd').textContent),
      nonal: parseFloat(document.getElementById('ratio-nonal').textContent)
    };
    const improvedCategory = { beer: 4, rtd: 5, nonal: 1 };

    ['beer','rtd','nonal'].forEach(k => {
      const now = currentCategory[k];
      const nxt = improvedCategory[k];
      const delta = (nxt - now).toFixed(1);
      const sign = delta > 0 ? "+" : delta < 0 ? "" : "Â±";
      document.getElementById(`improved-${k}`).textContent = nxt;
      const d = document.getElementById(`delta-${k}`);
      d.textContent = `ï¼ˆ${sign}${delta}ï¼‰`;
      d.className = delta > 0 ? 'ratio-delta plus' : delta < 0 ? 'ratio-delta minus' : 'ratio-delta';
    });

    /* 4-2 ã‚µãƒ–ã‚«ãƒ†æ§‹æˆæ¯” */
    const improvedBeer = {
      "ã‚¯ãƒ©ãƒ•ãƒˆ": 10,
      "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ“ãƒ¼ãƒ«": 18,
      "ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰": 22,
      "æ©Ÿèƒ½æ€§": 18,
      "ã‚¨ã‚³ãƒãƒŸãƒ¼": 32
    };
    const improvedRTD = {
      "ä½ã‚¢ãƒ«": 9, "é«˜ã‚¢ãƒ«": 8 ,"ç„¡ç³–": 30, "ä¸­ã‚¢ãƒ«": 13,
      "ãƒ¬ãƒ¢ãƒ³ã‚µãƒ¯ãƒ¼": 10, "ç„¼é…ç³»": 8, "ãƒãƒ©ã‚¨ãƒ†ã‚£ã‚µãƒ¯ãƒ¼": 2, "ãƒã‚¤ãƒœãƒ¼ãƒ«ãƒ»ã‚¸ãƒ³ã‚½ãƒ¼ãƒ€": 20
    };
    const improvedNonal = { "RTDãƒ†ã‚¤ã‚¹ãƒˆ": 50, "ãƒ“ãƒ¼ãƒ«ãƒ†ã‚¤ã‚¹ãƒˆ": 50 };

    function applyImproved(currentId, improvedId, improvedMap) {
      const currentBoxes = document.querySelectorAll(`#${currentId} .input-box`);
      const improvedBoxes = document.querySelectorAll(`#${improvedId} .input-box`);

      currentBoxes.forEach((box, idx) => {
        const label = box.querySelector('label').textContent.trim();
        const currentVal = safeParsePercent(box.querySelector('.percent').textContent);
        const newVal = improvedMap[label] ?? 0;
        const delta = newVal - currentVal;
        const sign = delta > 0 ? "+" : delta < 0 ? "" : "Â±";
        const displayDelta = `ï¼ˆ${sign}${delta}%ï¼‰`;

        const target = improvedBoxes[idx];
        target.querySelector('.percent').textContent = `${newVal}%`;
        const diffElem = target.querySelector('.diff');
        diffElem.textContent = displayDelta;
        diffElem.className = delta > 0 ? 'diff plus' : delta < 0 ? 'diff minus' : 'diff';
      });
    }

    applyImproved('currentBeer',  'improvedBeer',  improvedBeer);
    applyImproved('currentRTD',   'improvedRTD',   improvedRTD);
    applyImproved('currentNonal', 'improvedNonal', improvedNonal);

    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  }, 2000);
}

function showAiComment() {
  const spinner = document.getElementById("loadingSpinner");
  const aiSection = document.getElementById("aiReasoning");

  spinner.classList.remove("hidden");
  aiSection.classList.add("hidden");

  setTimeout(() => {
    spinner.classList.add("hidden");
    aiSection.classList.remove("hidden");
aiSection.scrollIntoView({ behavior: "smooth" });  }, 2000);
}

function submitChat() {
  const input = document.getElementById("chatInput");
  const message = input.value.trim();
  if (!message) return;

  const chatLog = document.getElementById("chatLog");

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¹ãå‡ºã—
  const userDiv = document.createElement("div");
  userDiv.className = "chat-message chat-user";
  userDiv.innerHTML = '<div class="chat-bubble">' + message + '</div>';
  chatLog.appendChild(userDiv);

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
  const loadingDiv = document.createElement("div");
  loadingDiv.className = "chat-message chat-ai";
  loadingDiv.id = "ai-loading";
loadingDiv.innerHTML = `
  <div class="ai-reason">
    <img src="AIã‚¤ãƒ©ã‚¹ãƒˆ.png" class="ai-icon" />
    <div class="ai-bubble">
      <span class="typing"></span><span class="typing"></span><span class="typing"></span>
    </div>
  </div>`;

  chatLog.appendChild(loadingDiv);
  chatLog.scrollTop = chatLog.scrollHeight;

  input.value = "";

  // ä»®ã®å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  let reply = "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å†…å®¹ã‚’ç¢ºèªã—ã¾ã—ãŸï¼";
  if (message.includes("ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ“ãƒ¼ãƒ«ã®æ§‹æˆæ¯”ãŒå¢—ãˆã¦ã„ã‚‹ã‚“ã ã‘ã©ã©ã†ã—ã¦ï¼Ÿ")) {
    reply = "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ»æ©Ÿèƒ½æ€§ãƒ“ãƒ¼ãƒ«ã®å£²å ´ã‚’åºƒã’ã‚‹ã¨ã€å®¢æ•°ã‚‚å£²ä¸Šã‚‚å¢—åŠ ãŒè¦‹è¾¼ã‚ã¾ã™ï¼æ¨å®šã§ã™ãŒã€å®¢æ•°ã¯105ï¼…ã€å£²ä¸Šã¯109ï¼…ãŒè¦‹è¾¼ã‚ãã†ã§ã™ã€‚";
  } else if (message.includes("ãƒ“ãƒ¼ãƒ«")) {
    reply = "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ»æ©Ÿèƒ½æ€§ãƒ“ãƒ¼ãƒ«ã®å£²å ´æ‹¡å¤§ãŒç‹™ã„ç›®ã§ã™ã€‚";
  }

  // 2ç§’å¾Œã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¶ˆã—ã¦AIã®è¿”ç­”ã‚’è¿½åŠ 
  setTimeout(() => {
    document.getElementById("ai-loading").remove();

    const aiDiv = document.createElement("div");
    aiDiv.className = "chat-message chat-ai";
aiDiv.innerHTML = `
  <div class="ai-reason">
    <img src="AIã‚¤ãƒ©ã‚¹ãƒˆ.png" class="ai-icon" />
    <div class="ai-bubble">${reply}</div>
  </div>`;
    chatLog.appendChild(aiDiv);
aiDiv.scrollIntoView({ behavior: "smooth" });

  }, 2000);
}
  </script>
</body>
</html>
